local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CoreGui = game:GetService("CoreGui")

-- Hàm kiểm tra chuỗi chứa HTTP
local function containsHttp(str)
    return string.find(str:lower(), "http") ~= nil
end

-- Hàm xóa phần tử hoặc kick người chơi nếu phát hiện HTTP
local function handleHttpDetection()
    game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off!")
    while true do task.wait() end
end

-- Kiểm tra các phần tử trong UI
local function checkUIElements(parent)
    for _, element in pairs(parent:GetChildren()) do
        if element:IsA("TextLabel") or element:IsA("TextButton") or element:IsA("TextBox") or element:IsA("Message") then
            if containsHttp(element.Text) then
                element:Destroy()
                handleHttpDetection()
            end
        end

        if containsHttp(element.Name) then
            element:Destroy()
            handleHttpDetection()
        end
    end
end

-- Giám sát CoreGui
local function monitorCoreGui()
    while true do
        checkUIElements(CoreGui)
        task.wait(1)
    end
end

-- Giám sát các PlayerGui mới được thêm vào
local function monitorNewPlayerGui()
    Players.PlayerAdded:Connect(function(player)
        player.ChildAdded:Connect(function(child)
            if child:IsA("ScreenGui") then
                checkUIElements(child)
            end
        end)
    end)
end

-- Giám sát các Script
local function monitorScripts()
    for _, script in pairs(game:GetDescendants()) do
        if script:IsA("Script") or script:IsA("LocalScript") then
            if containsHttp(script.Source) then
                handleHttpDetection()
            end
        end
    end
end

-- Giám sát các Module
local function monitorModules()
    for _, module in pairs(ReplicatedStorage:GetChildren()) do
        if module:IsA("ModuleScript") then
            if containsHttp(module.Source) then
                handleHttpDetection()
            end
        end
    end
end

-- Giám sát các RemoteEvents
local function monitorRemoteEvents()
    local function detectHttpInMessage(message)
        if containsHttp(message) then
            handleHttpDetection()
        end
    end

    for _, remote in pairs(ReplicatedStorage:GetChildren()) do
        if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
            remote.OnServerEvent:Connect(function(player, message)
                detectHttpInMessage(message)
            end)
        end
    end
end

-- Khởi chạy các monitor
spawn(function()
    monitorCoreGui()
    monitorNewPlayerGui()
    monitorScripts()
    monitorModules()
    monitorRemoteEvents()
end)
