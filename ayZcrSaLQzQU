local HttpService = game:GetService("HttpService")

local oldGetMetaTable = getmetatable
local oldSetMetaTable = setmetatable

local function checkForHooking()
    if getmetatable ~= oldGetMetaTable or setmetatable ~= oldSetMetaTable then
        game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off! Hook Detected!")
        return  
    end
end

setmetatable = function(t, mt)
    checkForHooking()  
    return oldSetMetaTable(t, mt)
end

getmetatable = function(t)
    checkForHooking()  
    return oldGetMetaTable(t)
end

local function checkUIElements(parent)
    for _, element in pairs(parent:GetChildren()) do
        local elementName = string.lower(element.Name)
        if string.find(elementName, "http") then
            element:Destroy()
            game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off!")
            return  
        end

        if (element:IsA("TextLabel") or element:IsA("TextButton") or element:IsA("TextBox") or element:IsA("Message")) then
            local elementText = string.lower(element.Text)
            if string.find(elementText, "http") then
                element:Destroy()
                game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off!")
                return  -- Dùng return để dừng hàm và ngừng thực thi mã tiếp theo
            end
        end
    end
end

local function monitorCoreGui()
    while true do
        checkUIElements(game:GetService("CoreGui"))
        task.wait(1)  
    end
end

local function monitorNewPlayerGui()
    game:GetService("Players").PlayerAdded:Connect(function(player)
        player.ChildAdded:Connect(function(child)
            if child:IsA("ScreenGui") then
                checkUIElements(child)
            end
        end)
    end)
end

local function monitorScripts()
    for _, script in pairs(game:GetDescendants()) do
        if script:IsA("Script") or script:IsA("LocalScript") then
            local scriptSource = script.Source
            if string.find(scriptSource, "HttpService:GetAsync") or string.find(scriptSource, "HttpService:PostAsync") then
                game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Request Detected in Script!")
                return  -- Dừng thực thi mã sau khi kick người chơi
            end
        end
    end
end

local function monitorModules()
    for _, module in pairs(game:GetService("ReplicatedStorage"):GetChildren()) do
        if module:IsA("ModuleScript") then
            local moduleSource = module.Source
            if string.find(moduleSource, "HttpService:GetAsync") or string.find(moduleSource, "HttpService:PostAsync") then
                game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Request Detected in Module!")
                return  -- Dừng thực thi mã sau khi kick người chơi
            end
        end
    end
end

local function monitorRemoteEvents()
    local function detectHttpInMessage(message)
        if string.find(message, "http") then
            game.Players.LocalPlayer:Kick("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Detected in RemoteEvent!")
            return  -- Dừng hàm nếu HTTP được phát hiện trong RemoteEvent
        end
    end

    for _, remote in pairs(game:GetService("ReplicatedStorage"):GetChildren()) do
        if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
            remote.OnServerEvent:Connect(function(player, message)
                detectHttpInMessage(message)
            end)
        end
    end
end

spawn(function()
    monitorCoreGui()  
    monitorNewPlayerGui()  
    monitorScripts()  
    monitorModules()  
    monitorRemoteEvents() 
end)
