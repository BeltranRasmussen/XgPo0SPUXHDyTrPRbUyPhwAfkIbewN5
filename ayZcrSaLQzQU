local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")

local function kickPlayer(message)
    game.Players.LocalPlayer:Kick(message)
end

local function hasHttp(text)
    return text and string.match(text:lower(), "http") ~= nil
end

local function checkUIElements(parent)
    for _, element in pairs(parent:GetChildren()) do
        if hasHttp(element.Name) then
            element:Destroy()
            kickPlayer("You Are Spying And Sabotaging Our Script, Please Turn It Off!")
            return
        end

        if (element:IsA("TextLabel") or element:IsA("TextButton") or element:IsA("TextBox") or element:IsA("Message")) then
            if hasHttp(element.Text) then
                element:Destroy()
                kickPlayer("You Are Spying And Sabotaging Our Script, Please Turn It Off!")
                return
            end
        end
    end
end

local function monitorScripts()
    for _, script in pairs(game:GetDescendants()) do
        if (script:IsA("Script") or script:IsA("LocalScript")) and (string.match(script.Source, "HttpService:GetAsync") or string.match(script.Source, "HttpService:PostAsync")) then
            kickPlayer("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Request Detected in Script!")
            return
        end
    end
end

local function monitorModules()
    for _, module in pairs(ReplicatedStorage:GetChildren()) do
        if module:IsA("ModuleScript") and (string.match(module.Source, "HttpService:GetAsync") or string.match(module.Source, "HttpService:PostAsync")) then
            kickPlayer("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Request Detected in Module!")
            return
        end
    end
end

local function monitorRemoteEvents()
    local function detectHttpInMessage(message)
        if hasHttp(message) then
            kickPlayer("You Are Spying And Sabotaging Our Script, Please Turn It Off! HTTP Detected in RemoteEvent!")
        end
    end

    for _, remote in pairs(ReplicatedStorage:GetChildren()) do
        if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
            remote.OnServerEvent:Connect(function(player, message)
                detectHttpInMessage(message)
            end)
        end
    end
end

local function monitorCoreGui()
    while true do
        checkUIElements(CoreGui)
        task.wait(1)
    end
end

local function monitorNewPlayerGui()
    Players.PlayerAdded:Connect(function(player)
        player.ChildAdded:Connect(function(child)
            if child:IsA("ScreenGui") then
                checkUIElements(child)
            end
        end)
    end)
end

spawn(function()
    monitorCoreGui()
    monitorNewPlayerGui()
    monitorScripts()
    monitorModules()
    monitorRemoteEvents()
end)
